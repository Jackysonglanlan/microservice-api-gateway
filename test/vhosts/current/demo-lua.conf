#

# lua require() 的装载路径, 注意 libs 下的子目录需要通过 '.' 来访问
# 比如:
# require('foo.bar')，openresty 会去寻找 $prefix/lua/libs/foo/bar.lua
lua_package_path "$prefix/../lua/libs/?.lua;;";

server {
  listen localhost:7777;

  location = /demo-lua-json {
    default_type application/json;

    content_by_lua_block {
      -- cjson is pre-loaded in nginx.conf via 'init_by_lua_block'
      -- so below is fast-require

      local cjson = require("cjson")
      ngx.say(cjson.encode({type = "embed", msg = "hahahhhh"}))
    }
  }

  location ~ ^/lua-demo/(.+) {
    default_type text/html;

    content_by_lua_file lua-demo/$1.lua;
  }

}
